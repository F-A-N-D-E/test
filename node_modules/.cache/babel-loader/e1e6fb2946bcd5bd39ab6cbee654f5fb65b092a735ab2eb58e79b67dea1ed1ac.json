{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useParams}from\"react-router-dom\";import{nanoid}from'nanoid';import FormCSS from'../styles/Form.module.css';import QUEForm from\"./QUEForm\";import{setDefultLocalStorage,setLocalDefultLocalStorage}from\"../layouts/additionaleFunc\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Form(){let params=useParams();const[list,setList]=useState();const[extraInfo,setExtraInfo]=useState({nameTest:'',privat:false});useEffect(()=>{if(getDataFromDB()){let dataForCreateExtraInfo=JSON.parse(localStorage.getItem('dataForCreateExtraInfo'));let dataForCreate=JSON.parse(localStorage.getItem('dataForCreate'));if(!dataForCreate){setDefultLocalStorage('dataForCreate');}else setList(dataForCreate);if(!dataForCreateExtraInfo){setDefultLocalStorage('dataForCreateExtraInfo');}else setExtraInfo(dataForCreateExtraInfo);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"form\",{method:\"post\",onKeyDown:e=>{if(e.key==='Enter')e.preventDefault();},children:[extraInfo.nameTest||extraInfo.nameTest===''?/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"nameTest\",className:FormCSS.inp_name,placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u0435\\u0441\\u0442\\u0430\",autoComplete:\"off\",value:extraInfo.nameTest,onChange:e=>{let copy={...extraInfo};copy.nameTest=e.target.value;setExtraInfo(copy);if(!params.idTest)localStorage.setItem('dataForCreateExtraInfo',JSON.stringify(extraInfo));}}):'qwe',list?/*#__PURE__*/_jsx(_Fragment,{children:list.map((elem,index)=>{return/*#__PURE__*/_jsx(QUEForm,{elemFromState:elem,number:index,remove:remove,last:index===list.length-1,add:add,mainList:list,mainSetList:setList,extraInfo:extraInfo,setExtraInfo:setExtraInfo},index);})}):\"ывлмыдлвтм\"]})});/* \r\n        {\r\n            nameTest: name: str,\r\n            privat: 'on'||undefinde,\r\n            [num + 'textQUE']: textQuestion: str,\r\n            [num + 'type']: type: 'radio' || 'checkbox' || 'text',\r\n            [num + ans: 'answerTrue' || 'answerFalse']: answer: str || str[],\r\n            ...\r\n        }\r\n    */async function getDataFromDB(){if(params.idTest){await fetch(`/create/${params.name}/${params.idTest}`).then(r=>r.json()).then(r=>{setList(r.data);setExtraInfo({nameTest:r.nameTest,privat:r.privat});}).catch(err=>console.log(err));return false;}return true;}function add(){let copy=[...list];copy=[...copy,{id:nanoid(10),type:'radio',text:'',answerTrue:[[nanoid(3),'']],answerFalse:[[nanoid(3),'']]}];setList(copy);if(!params.idTest)localStorage.setItem('dataForCreate',JSON.stringify(copy));}function remove(id){let copy=[...list];let index=copy.findIndex(elem=>elem.id===id);copy.splice(index,1);setList(copy);if(!params.idTest)localStorage.setItem('dataForCreate',JSON.stringify(copy));}}","map":{"version":3,"names":["React","useState","useEffect","useParams","nanoid","FormCSS","QUEForm","setDefultLocalStorage","setLocalDefultLocalStorage","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Form","params","list","setList","extraInfo","setExtraInfo","nameTest","privat","getDataFromDB","dataForCreateExtraInfo","JSON","parse","localStorage","getItem","dataForCreate","children","method","onKeyDown","e","key","preventDefault","type","name","className","inp_name","placeholder","autoComplete","value","onChange","copy","target","idTest","setItem","stringify","map","elem","index","elemFromState","number","remove","last","length","add","mainList","mainSetList","fetch","then","r","json","data","catch","err","console","log","id","text","answerTrue","answerFalse","findIndex","splice"],"sources":["D:/javascript/express-react-app/client/src/FormCreate/Form.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { nanoid } from 'nanoid';\r\n\r\nimport FormCSS from '../styles/Form.module.css'\r\nimport QUEForm from \"./QUEForm\";\r\nimport { setDefultLocalStorage, setLocalDefultLocalStorage } from \"../layouts/additionaleFunc\";\r\n\r\nexport default function Form() {\r\n    let params = useParams()\r\n\r\n    const [list, setList] = useState()\r\n    const [extraInfo, setExtraInfo] = useState(\r\n        {\r\n            nameTest: '',\r\n            privat: false\r\n        }\r\n    )\r\n\r\n    useEffect(() => {\r\n        if (getDataFromDB()) {\r\n            let dataForCreateExtraInfo = JSON.parse(localStorage.getItem('dataForCreateExtraInfo'))\r\n            let dataForCreate = JSON.parse(localStorage.getItem('dataForCreate'))\r\n            if (!dataForCreate) {\r\n                setDefultLocalStorage('dataForCreate')\r\n            } else setList(dataForCreate)\r\n            if (!dataForCreateExtraInfo) {\r\n                setDefultLocalStorage('dataForCreateExtraInfo')\r\n            } else setExtraInfo(dataForCreateExtraInfo)\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [])\r\n    return (<>\r\n        <form method=\"post\" onKeyDown={(e) => { if (e.key === 'Enter') e.preventDefault() }}>\r\n\r\n            {extraInfo.nameTest || extraInfo.nameTest === '' ?\r\n                <input type=\"text\" name=\"nameTest\" className={FormCSS.inp_name} placeholder=\"Введите название теста\" autoComplete=\"off\" value={extraInfo.nameTest} onChange={(e) => {\r\n                    let copy = { ...extraInfo }\r\n                    copy.nameTest = e.target.value\r\n                    setExtraInfo(copy)\r\n                    if (!params.idTest) localStorage.setItem('dataForCreateExtraInfo', JSON.stringify(extraInfo))\r\n                }} />\r\n                :\r\n                'qwe'\r\n            }\r\n\r\n            {list ? <>\r\n                {list.map((elem, index) => {\r\n                    return <QUEForm\r\n                        key={index}\r\n                        elemFromState={elem}\r\n                        number={index}\r\n                        remove={remove}\r\n                        last={index === list.length - 1}\r\n                        add={add}\r\n\r\n                        mainList={list}\r\n                        mainSetList={setList}\r\n                        extraInfo={extraInfo}\r\n                        setExtraInfo={setExtraInfo}\r\n                    />\r\n                })}\r\n            </>\r\n                :\r\n                \"ывлмыдлвтм\"\r\n            }\r\n\r\n        </form>\r\n    </>)\r\n    /* \r\n        {\r\n            nameTest: name: str,\r\n            privat: 'on'||undefinde,\r\n            [num + 'textQUE']: textQuestion: str,\r\n            [num + 'type']: type: 'radio' || 'checkbox' || 'text',\r\n            [num + ans: 'answerTrue' || 'answerFalse']: answer: str || str[],\r\n            ...\r\n        }\r\n    */\r\n\r\n\r\n    async function getDataFromDB() {\r\n        if (params.idTest) {\r\n            await fetch(`/create/${params.name}/${params.idTest}`)\r\n                .then(r => r.json())\r\n                .then(r => {\r\n                    setList(r.data)\r\n                    setExtraInfo({\r\n                        nameTest: r.nameTest,\r\n                        privat: r.privat\r\n                    })\r\n                })\r\n                .catch(err => console.log(err))\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n\r\n\r\n    function add() {\r\n        let copy = [...list]\r\n\r\n        copy = [...copy,\r\n        {\r\n            id: nanoid(10),\r\n            type: 'radio',\r\n            text: '',\r\n            answerTrue: [\r\n                [nanoid(3), '']\r\n            ],\r\n            answerFalse: [\r\n                [nanoid(3), '']\r\n            ],\r\n        }\r\n        ]\r\n        setList(copy)\r\n        if (!params.idTest) localStorage.setItem('dataForCreate', JSON.stringify(copy))\r\n    }\r\n\r\n    function remove(id) {\r\n        let copy = [...list]\r\n        let index = copy.findIndex(elem => elem.id === id)\r\n\r\n        copy.splice(index, 1)\r\n        setList(copy)\r\n        if (!params.idTest) localStorage.setItem('dataForCreate', JSON.stringify(copy))\r\n    }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}